## 1. s0 - 支持 UrlList.txt 中的所有系统/架构（最高优先级）
- [ ] 1.1 创建UrlList.txt解析器模块
  - 新建 `src/utils/urllist_parser.rs`
  - 解析格式：` **{distro}**:`, `URL['{arch}']="{url}"`
  - 返回数据结构：HashMap<distro, HashMap<arch, url>>
  - 测试场景：解析UrlList.txt并验证数据完整性

- [ ] 1.2 检测当前系统架构
  - 使用 `std::env::consts::ARCH` 或类似API
  - 支持：aarch64, arm, x86_64, i686, riscv64
  - 测试场景：在不同架构设备上检测

- [ ] 1.3 集成UrlList.txt到发行版选择流程
  - 修改 `src/distro/definitions.rs`
  - 动态生成发行版列表而非硬编码
  - 测试场景：显示所有UrlList.txt中的发行版

- [ ] 1.4 实现架构到URL的映射逻辑
  - 根据当前架构选择正确的URL
  - 处理架构不支持的情况
  - 测试场景：尝试安装不支持的架构

- [ ] 1.5 更新交互式菜单和命令行参数
  - 修改 `src/cli/interactive.rs`
  - 显示所有可用发行版
  - 测试场景：交互式选择和命令行安装

## 2. s1 - 修复退出系统时的 panic 问题
- [ ] 2.1 修复CLI卸载系统时的index out of bounds panic
  - 修改 `src/cli/interactive.rs` 或 `src/cli/mod.rs`
  - 在访问系统列表前检查是否为空
  - 如果列表为空，显示提示信息并返回主菜单
  - 测试场景：无系统安装时选择"卸载系统"

## 3. s2 - 动态获取真实数据（移除硬编码）
- [ ] 3.1 移除硬编码的用户名，改为动态获取
  - 修改 `src/installer/` 相关文件
  - 使用系统API获取实际用户名
  - 测试场景：不同用户安装系统

- [ ] 3.2 移除硬编码的用户组信息，改为动态获取
  - 修改权限设置相关代码
  - 使用系统API获取用户组信息
  - 测试场景：验证文件权限正确设置

- [ ] 3.3 使用真实系统时间而非硬编码
  - 修改元数据记录功能
  - 使用系统时间API获取当前时间
  - 测试场景：检查meta.txt中的时间戳

## 4. s3 - {distro}-init 配置项支持
- [ ] 4.1 扩展配置解析器支持多行字符串
  - 修改 `src/config/parser.rs`
  - 支持 `---\n...\n---` 格式
  - 测试场景：读取包含{distro}-init的配置文件

- [ ] 4.2 存储{distro}-init命令到配置结构
  - 修改 `src/config/defaults.rs` 或相关结构体
  - 添加字段存储初始化命令
  - 测试场景：验证配置加载后包含init命令

- [ ] 4.3 在安装过程中执行init命令
  - 修改 `src/installer/mod.rs` 或 `src/installer/interactive.rs`
  - 在系统提取后、创建start.sh前执行
  - 在chroot环境中执行命令
  - 测试场景：安装Ubuntu并配置ubuntu-init

- [ ] 4.4 错误处理和日志记录
  - 捕获init命令执行错误
  - 记录到日志但不中断安装
  - 测试场景：配置错误的init命令

## 5. s4 - 安装完成后询问是否立即启动系统
- [ ] 5.1 在安装完成时添加提示
  - 修改 `src/installer/interactive.rs`
  - 显示"是否立即启动系统？(Y/N)"
  - 测试场景：完成安装后看到提示

- [ ] 5.2 实现立即启动逻辑
  - 如果用户选择Y，执行start.sh
  - 使用正确的环境变量
  - 测试场景：选择Y后系统自动启动

- [ ] 5.3 显示手动启动命令
  - 如果用户选择N，显示启动命令
  - 显示系统目录路径
  - 测试场景：选择N后看到命令提示

## 6. s5 - 实现真实的进度条
- [ ] 6.1 实现下载进度跟踪
  - 修改 `src/utils/net.rs` 或下载相关代码
  - 使用Content-Length头获取总大小
  - 计算已下载字节数
  - 测试场景：下载大文件观察进度

- [ ] 6.2 实现解压进度跟踪
  - 修改解压相关代码
  - 对于tar文件：跟踪已处理文件数或字节数
  - 测试场景：解压大文件观察进度

- [ ] 6.3 集成真实进度到UI组件
  - 修改 `src/ui/progress.rs`
  - 替换模拟进度为真实进度数据
  - 测试场景：完整安装过程观察进度条

- [ ] 6.4 处理未知大小的进度显示
  - 实现不确定进度指示器
  - 显示已传输字节数
  - 测试场景：下载无Content-Length的文件

## 7. s6 - 模块化重构代码（文件≤5KB）
- [ ] 7.1 分析当前代码文件大小
  - 检查src/目录下所有文件
  - 识别超过5KB的文件
  - 测试场景：生成文件大小报告

- [ ] 7.2 拆分超大文件
  - 将大文件拆分为逻辑模块
  - 保持功能完整性和接口一致性
  - 测试场景：验证拆分后功能正常

- [ ] 7.3 优化模块依赖关系
  - 检查循环依赖
  - 优化模块接口
  - 测试场景：编译并通过所有测试

## 8. s7 - CLI界面添加颜色支持
- [ ] 8.1 创建颜色主题模块
  - 新建或修改 `src/ui/colors.rs`
  - 定义颜色常量：绿(成功)、红(错误)、黄(警告)、蓝(信息)
  - 测试场景：打印彩色文本

- [ ] 8.2 实现颜色启用/禁用逻辑
  - 检查--no-color标志
  - 检查终端颜色支持
  - 测试场景：使用--no-color参数

- [ ] 8.3 在CLI消息中应用颜色
  - 修改 `src/cli/` 相关文件
  - 成功消息使用绿色
  - 错误消息使用红色
  - 警告消息使用黄色
  - 信息消息使用蓝色
  - 测试场景：观察各种消息的颜色

- [ ] 8.4 在进度条中应用颜色
  - 修改 `src/ui/progress.rs`
  - 进度条填充使用亮色
  - 百分比使用粗体
  - 测试场景：观察彩色进度条

## 9. s8 - 将"最小化安装"更名为"最小安装"
- [ ] 9.1 重命名"最小化安装"为"最小安装"
  - 搜索所有语言文件（en.toml, zh.toml）
  - 搜索代码中的硬编码字符串
  - 替换为"最小安装"
  - 测试场景：查看安装模式选项

## 10. 测试和验证
- [ ] 10.1 编写单元测试
  - 为UrlList.txt解析器编写测试
  - 为配置解析编写测试
  - 为进度条组件编写测试
  - 测试场景：运行cargo test

- [ ] 10.2 手动测试主要流程
  - 测试安装不同发行版（ubuntu, debian, alpine）
  - 测试卸载系统（包括空列表情况）
  - 测试配置{distro}-init
  - 测试--no-color参数
  - 测试安装后立即启动
  - 测试场景：所有主要功能正常工作

- [ ] 10.3 验证代码文件大小限制
  - 检查所有src/文件≤5KB
  - 如有超出，继续拆分
  - 测试场景：确认模块化目标达成

## 11. 文档更新
- [ ] 11.1 更新README.md
  - 添加新支持的发行版列表
  - 说明UrlList.txt的使用
  - 说明{distro}-init配置
  - 更新命令行选项说明

- [ ] 11.2 更新配置示例
  - 在README中添加{distro}-init示例
  - 添加颜色选项说明
  - 测试场景：文档清晰准确
